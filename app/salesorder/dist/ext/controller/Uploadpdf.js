sap.ui.define(["sap/ui/core/Fragment","sap/m/Button","sap/m/MessageToast"],function(e,t,a){"use strict";var o=false;var s=function(t,s,i,l){var r=e.byId("uploadPdfFragment","uploadSet");var n=r.getAggregation("incompleteItems");if(n.length===0){a.show("Please choose a file first.");return}var g=n[0].getFileObject();if(g.size>200*1024){a.show("Large file detected. Uploading may take a while. Please wait...",{duration:5e3})}else{a.show("Uploading file. Please wait...",{duration:2e3})}s.setBusy(true);var d=new FileReader;d.onload=async function(e){try{const o=URL.createObjectURL(g);var t={attachments:[{filename:g.name,mimeType:g.type,url:o,content:e.target.result.split(",")[1]}]};var n="/salesorder";var d=i.bindList(n);debugger;let s="processDocument";let r={model:l.getView().getModel(),parameterValues:[{name:"salesOrder",value:t}],invocationGrouping:"isolated",skipParameterDialog:true};var u=await l.invokeAction(s,r).then(function(e){debugger});debugger;a.show("File processed successfully!")}catch(e){a.show("Error uploading file: "+e.message)}finally{s.setBusy(false);o=false;s.close();r.removeAllItems()}};d.readAsDataURL(g)};return{UploadPdf:function(i){var l=this;var r=this.getModel();debugger;var n=this.getEditFlow();o=true;if(!this.oDialog){e.load({id:"uploadPdfFragment",name:"salesorder.ext.controller.Uploadpdf",type:"XML",controller:this}).then(function(e){l.oDialog=e;l.oDialog.setBeginButton(new t({text:"Upload",press:function(e){s(e,l.oDialog,r,n)}}));l.oDialog.setEndButton(new t({text:"Close",press:function(){l.oDialog.close()}}));l.oDialog.open()}).catch(function(e){a.show("Error loading PDF Upload Dialog: "+e.message)})}else{this.oDialog.open()}}}});
//# sourceMappingURL=Uploadpdf.js.map