sap.ui.define(["sap/ui/core/Fragment","sap/m/Button","sap/m/MessageToast","sap/ui/model/json/JSONModel"],function(e,a,t,i){"use strict";var l=function(a,i){var l=e.byId("idFileUploadDialogFragmentDefinition","idFileUploader");var o=e.byId("idFileUploadDialogFragmentDefinition","idProgressIndicator");if(!l.getValue()){t.show("Please select a file first.");return}a.setBusy(true);o.setDisplayValue("0%");o.setPercentValue(0);var n=l.oFileUpload.files;if(n.length>0){var s=n[0];var r=new FileReader;r.onprogress=function(e){if(e.lengthComputable){var a=Math.round(e.loaded/e.total*100);o.setDisplayValue(a+"%");o.setPercentValue(a)}};r.onload=async function(e){try{const a=URL.createObjectURL(s);var i={attachments:[{filename:s.name,mimeType:s.type,url:a,content:e.target.result}]}}catch(e){t.show("Error uploading file: "+e.message)}finally{a.setBusy(false);l.clear();o.setDisplayValue("0%");o.setPercentValue(0);a.close()}};r.readAsDataURL(s)}};return{FileUploadDialog:function(){var i=this;var o=this.getModel();var n=this.getEditFlow();var s="/salesorder";var r=o.bindList(s);var d=r.create();d.created();debugger;if(!this.pDialog){e.load({id:"idFileUploadDialogFragmentDefinition",name:"salesorder.ext.controller.FileUploadDialog",type:"XML",controller:this}).then(function(e){i.pDialog=e;i.getEditFlow().getView().addDependent(i.pDialog);i.pDialog.setBeginButton(new a({text:"Upload",press:function(){l(i.pDialog,n)}}));i.pDialog.setEndButton(new a({text:"Cancel",press:function(){i.pDialog.close()}}));i.pDialog.open()}).catch(function(e){t.show("Error loading dialog: "+e.message)})}else{this.pDialog.open()}},closeAddViaUrlFragment:function(){this.pDialog.close()}}});
//# sourceMappingURL=FileUploadDialog.js.map